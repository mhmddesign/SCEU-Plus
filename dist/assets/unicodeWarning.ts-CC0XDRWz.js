(function(){if(window.self===window.top){const e=window.location.hostname;e&&e.toLowerCase()!=="localhost"&&(/[^\u0000-\u007f]/.test(e)||e.toLowerCase().includes("xn--"))&&(console.log("[Extension Suite] IDN detected:",e),w(e))}async function w(e){var n;try{const o=(await chrome.storage.sync.get("settings")).settings;if(!((n=o==null?void 0:o.unicodeWarning)!=null&&n.enabled)){console.log("[Extension Suite] Unicode Warning disabled, skipping");return}const{whitelist:s,allowedChars:i}=o.unicodeWarning;if(s&&s.includes(e)){console.log("[Extension Suite] Domain is whitelisted:",e);return}if(i&&i.length>0){const d=f(e);if([...d].every(a=>a.codePointAt(0)<=127||i.includes(a))){console.log("[Extension Suite] All unicode chars are allowed:",d);return}}const r=await chrome.storage.local.get(["tempDismissed","sessionToken"]),c=chrome.runtime.getURL("src/warning/index.html"),u=c;let l=r.tempDismissed||[];if(r.sessionToken!==u&&(l=[]),l.includes(e)){console.log("[Extension Suite] Domain temporarily dismissed:",e);return}console.log("[Extension Suite] Redirecting to warning page for:",e);const g=encodeURIComponent(window.location.href);window.location.replace(`${c}?target=${g}`)}catch(t){console.error("[Extension Suite] Error in Unicode Warning:",t)}}function f(e){try{return new URL(`http://${e}`).hostname}catch{return e}}
})()
