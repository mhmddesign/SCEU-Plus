import{c as m,r as c,j as e,C as k,e as b,f as j,h as y,i as N,B as l,k as C,R as v}from"./globals-TrF1dlGY.js";import{S as A}from"./shield-alert-D81vnC42.js";import{A as D}from"./alert-triangle-DuNs9skI.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=m("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=m("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);function W(){const n=new URLSearchParams(window.location.search).get("target")||"",[r,d]=c.useState(""),[o,h]=c.useState(""),[x,g]=c.useState(!1);c.useEffect(()=>{const s=window.matchMedia("(prefers-color-scheme: dark)").matches;document.documentElement.classList.toggle("dark",s);try{const t=new URL(n);d(t.hostname),h(t.hostname)}catch{d("Unknown Domain")}g(window.history.length>1)},[n]);const u=()=>{window.history.back()},p=async()=>{try{const s=await chrome.storage.local.get(["tempDismissed","sessionToken"]),t=chrome.runtime.getURL("src/warning/index.html");let a=s.tempDismissed||[],i=s.sessionToken;i!==t&&(a=[],i=t),a.includes(r)||a.push(r),await chrome.storage.local.set({tempDismissed:a,sessionToken:i}),await chrome.runtime.sendMessage({type:"LOG_WARNING",payload:{domain:r,unicodeDomain:o,action:"proceeded"}}),window.location.replace(n)}catch(s){console.error("Failed to proceed:",s),window.location.replace(n)}},w=async()=>{try{const t=(await chrome.storage.sync.get("settings")).settings||{},a=t.unicodeWarning||{enabled:!0,whitelist:[],whitelistMetadata:{},allowedChars:""};a.whitelist.includes(r)||(a.whitelist.push(r),a.whitelistMetadata[r]={added:new Date().toISOString().split("T")[0],title:"Whitelisted via Warning Page"}),await chrome.storage.sync.set({settings:{...t,unicodeWarning:a}}),await chrome.runtime.sendMessage({type:"LOG_WARNING",payload:{domain:r,unicodeDomain:o,action:"whitelisted"}}),window.location.replace(n)}catch(s){console.error("Failed to whitelist:",s),window.location.replace(n)}},f=s=>[...s].map((t,a)=>{const i=t.codePointAt(0)>127;return e.jsx("span",{className:i?"text-red-500 font-bold underline decoration-wavy":"",title:i?`U+${t.codePointAt(0).toString(16).toUpperCase()}`:void 0,children:t},a)});return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-amber-50 to-orange-100 dark:from-gray-900 dark:to-gray-800 p-4",children:e.jsxs(k,{className:"max-w-lg w-full shadow-xl",children:[e.jsxs(b,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-amber-100 dark:bg-amber-900/30",children:e.jsx(A,{className:"h-8 w-8 text-amber-600 dark:text-amber-500"})}),e.jsx(j,{className:"text-xl text-amber-700 dark:text-amber-500",children:"⚠️ Unicode Domain Warning"}),e.jsx(y,{children:"This domain contains non-ASCII characters that could be used for phishing"})]}),e.jsxs(N,{className:"space-y-4",children:[e.jsxs("div",{className:"rounded-lg bg-muted p-4 text-center space-y-2",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"You are trying to visit:"}),e.jsx("p",{className:"text-lg font-mono font-bold break-all",children:f(o||r)}),r!==o&&e.jsxs("p",{className:"text-xs text-muted-foreground font-mono",children:["Punycode: ",r]})]}),e.jsx("div",{className:"rounded-lg bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 p-3 text-sm",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(D,{className:"h-4 w-4 text-amber-600 mt-0.5 shrink-0"}),e.jsxs("div",{className:"text-amber-800 dark:text-amber-300",children:[e.jsx("p",{className:"font-medium mb-1",children:"Why am I seeing this?"}),e.jsx("p",{className:"text-amber-700 dark:text-amber-400 text-xs",children:'Attackers use look-alike Unicode characters to create fake domains (e.g., "аpple.com" using Cyrillic "а" instead of Latin "a").'})]})]})}),e.jsxs("div",{className:"grid gap-2",children:[e.jsxs(l,{variant:"outline",onClick:u,disabled:!x,className:"w-full",children:[e.jsx(S,{className:"h-4 w-4 mr-2"}),"Go Back to Safety"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(l,{variant:"secondary",onClick:p,className:"w-full",children:"Continue Once"}),e.jsxs(l,{variant:"default",onClick:w,className:"w-full",children:[e.jsx(U,{className:"h-4 w-4 mr-2"}),"Trust & Whitelist"]})]})]}),e.jsx("p",{className:"text-xs text-center text-muted-foreground",children:'If you trust this site, click "Trust & Whitelist" to never see this warning again.'})]})]})})}C.createRoot(document.getElementById("root")).render(e.jsx(v.StrictMode,{children:e.jsx(W,{})}));
